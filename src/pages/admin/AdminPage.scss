@import '../../styles/globals.scss';

ul,
li {
   list-style: none;
   padding: 0;
   margin: 0;
}

.layout {
   display: flex;
   height: 100vh;
   background-color: $white;
   color: $gray1;
   position: relative;

   .sidebar {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      max-width: 280px;
      transition:
         transform 0.3s ease,
         opacity 0.3s ease;
   }

   .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      max-width: 1385px;
      transition: margin-left 0.3s ease;
      width: 100%;
      min-width: 0;
      overflow: hidden;
      height: 100vh;

      > *:not(.header) {
         flex: 1;
         min-height: 0;
         overflow-y: auto;
         overflow-x: hidden;
         scrollbar-width: none;
         -ms-overflow-style: none;
         &::-webkit-scrollbar {
            display: none;
         }
      }
   }

   .history-panel {
      width: 100%;
      max-width: 280px;
      transition:
         transform 0.3s ease,
         opacity 0.3s ease;
   }
}

.sidebar {
   padding: $spacing-4 $spacing-2;
   justify-content: space-between;
   height: 100%;
   width: 100%;
   border-right: 1px solid $gray5;
   background-color: $white;
   z-index: $z-index-fixed;
   transition:
      transform 0.3s ease,
      opacity 0.3s ease;

   &:not(.visible) {
      @media (min-width: 1025px) {
         display: none;
      }
   }

   .sidebar-header {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      position: relative;

      img {
         flex-shrink: 0;
      }

      .sidebar-back-button {
         position: absolute;
         left: 0;
      }
   }

   .sidebar-back-button {
      display: none; // 데스크톱에서는 숨김
      background: none;
      border: none;
      padding: $spacing-1;
      font-size: $body-normal-size;
      color: $gray1;
      cursor: pointer;
      transition: $transition-base;
      white-space: nowrap;

      &:hover {
         opacity: 0.7;
      }

      &:active {
         opacity: 0.5;
      }
   }

   nav {
      width: 100%;
   }
   a {
      display: block;
      width: 100%;
      text-decoration: underline;
      color: $gray3;
   }
}

.sidebar--tap {
   margin-top: $spacing-5;
   height: 100%;
   ul {
      display: flex;
      flex-direction: column;
      gap: 4px;
      justify-content: center;
      align-items: start;
      li {
         padding: 0.75rem;
         width: 100%;
         img {
            margin-right: 0.75rem;
         }
      }
      li.active {
         background-color: $gray5;
         border-radius: 8px;
      }
   }
}
.admin--tap {
   display: flex;
   max-height: 32px;
   justify-content: space-between;
   width: 100%;
   margin-bottom: $spacing-1;
}
.admin-profile {
   display: flex;
   gap: $spacing-1;
   width: 100%;
   p {
      margin: 0;
   }
}

.header {
   display: flex;
   justify-content: space-between;
   padding: $spacing-2 $spacing-3;
   border-bottom: 1px solid $gray5;
   flex-shrink: 0;
   position: sticky;
   top: 0;
   z-index: 100;
   background-color: $white;
   width: 100%;

   p {
      margin: 0;
      padding: $spacing-1 $spacing-2;
   }
}
.header-left,
.header-right,
.icons {
   display: flex;
   gap: $spacing-1;
   justify-content: center;
   align-items: center;
}
.header-right .icons img:hover {
   cursor: pointer;
}

.header-history-icon {
   @media (max-width: 1024px) {
      display: none;
   }
}

.header-right .icons {
   @media (max-width: 1024px) {
      display: none;
   }
}

.history-panel {
   display: flex;
   flex-direction: column;
   gap: 4px;
   border-left: 1px solid $gray5;
   padding: $spacing-4 $spacing-2;
   background-color: $white;
   z-index: $z-index-fixed;
   transition:
      transform 0.3s ease,
      opacity 0.3s ease;

   &:not(.visible) {
      @media (min-width: 1025px) {
         display: none;
      }
   }

   p {
      margin: 0;
   }
   > p {
      padding: $spacing-1 0;
   }
   ul li {
      display: flex;
      gap: $spacing-1;
      padding: $spacing-1;
      align-items: start;
      span {
         font-size: 0.75rem;
         color: $gray3;
      }
   }
}
.text {
   display: flex;
   flex-direction: column;
}

.admin-content {
   padding: $spacing-3 $spacing-2;
   width: 100%;
   display: flex;
   flex-direction: column;
   justify-content: flex-start;
   align-items: center;
   margin: 0 auto;
   position: relative;
   min-height: 0;

   * {
      max-width: 1116px;
   }
   .button {
      display: block;
      width: 100%;
      text-align: right;
      margin-top: $spacing-5;

      button {
         max-width: 130px;
      }
   }

   .pagination {
      margin-top: $spacing-4;
   }
}

.admin-content .table {
   width: 100%;
   overflow-x: visible;
   position: relative;
   z-index: 1;
   display: flex;
   flex-direction: column;
   height: auto;
   min-height: auto;
   margin-bottom: 0;

   ul {
      width: 100%;
      display: grid;
      align-items: stretch;
      padding: 0 $spacing-1;
      min-width: fit-content;
      flex-shrink: 0;
      min-height: auto;
      height: auto;
      grid-auto-rows: auto;
      gap: $spacing-1;
   }

   &.user-table ul {
      grid-template-columns: minmax(120px, 1fr) 1fr 1fr minmax(80px, auto) minmax(80px, auto) minmax(100px, auto);
   }

   &.topic-table ul {
      grid-template-columns: minmax(150px, 1fr) 1fr 1fr 1fr 1fr;
   }

   &.inquiry-table ul {
      grid-template-columns: minmax(80px, auto) minmax(140px, 1fr) 1fr minmax(120px, auto) minmax(120px, auto) minmax(80px, auto);

      li:nth-child(2) {
         overflow: visible;
         min-width: 0;

         > * {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            min-width: 0;
         }

         img {
            max-width: 24px;
            min-width: 24px;
            width: 24px;
            height: 24px;
            object-fit: cover;
         }
      }
   }

   &.report-table ul {
      grid-template-columns: minmax(120px, 1fr) minmax(120px, 1fr) minmax(180px, auto) minmax(120px, auto) minmax(80px, auto);

      li:nth-child(3) {
         overflow: visible;
         min-width: fit-content;

         > * {
            overflow: visible;
            text-overflow: clip;
            white-space: nowrap;
            min-width: fit-content;
         }
      }

      li:nth-child(2) {
         overflow: visible;
         min-width: 0;

         > * {
            overflow: visible;
            text-overflow: clip;
            white-space: nowrap;
            min-width: 0;
         }

         img {
            max-width: 24px;
            min-width: 24px;
            width: 24px;
            height: 24px;
            object-fit: cover;
         }
      }
   }

   &.comment-table ul {
      grid-template-columns: minmax(120px, 1fr) 1fr 1fr 1fr 1fr 1fr;
   }
   ul.header {
      color: $gray4;
      position: relative;
      z-index: 1;
      border-bottom: none;
   }

   ul.data {
      flex-shrink: 0;
      min-height: auto;
      margin-bottom: 0;
      cursor: pointer;
      transition: background-color 0.2s ease;

      &:hover {
         background-color: $gray5;
      }

      img {
         max-width: 24px;
         margin-right: $spacing-1;
      }
   }

   ul.header + ul.data {
      border-top: 1px solid $gray5;
   }

   ul li {
      min-width: 0;
      display: flex;
      justify-content: start;
      align-items: center;
      padding: $spacing-1 $spacing-2;
      min-height: auto;
      overflow: hidden;
      white-space: nowrap;

      > * {
         overflow: hidden;
         text-overflow: ellipsis;
         white-space: nowrap;
         min-width: 0;
      }

      &:first-child {
         overflow: visible;
         min-width: 0;

         > * {
            overflow: visible;
            text-overflow: clip;
            white-space: nowrap;
            min-width: 0;
         }

         img {
            max-width: 24px;
            min-width: 24px;
            width: 24px;
            height: 24px;
            object-fit: cover;
         }
      }

      input[type='checkbox'] {
         overflow: visible;
         text-overflow: clip;
         white-space: normal;
         flex-shrink: 0;
         cursor: pointer;
         margin: 0;
      }

      img {
         overflow: visible;
         text-overflow: clip;
         white-space: normal;
         flex-shrink: 0;
      }

      &.status {
         cursor: pointer;

         &--completed {
            color: $success-color;
         }

         &--pending {
            color: $info-color;
         }

         &--reported {
            color: $warning-color;
         }

         &--clickable {
            text-decoration: underline;
         }
      }
   }

   // inquiry-table 상태 색상
   &.inquiry-table ul li.status {
      &--completed {
         color: $success-color;
      }

      &--pending {
         color: $danger-color;
      }

      &--reported {
         color: $warning-color;
      }
   }

   // report-table 상태 색상
   &.report-table ul li.status {
      &--completed {
         color: $success-color;
      }

      &--pending {
         color: $info-color;
         text-decoration: underline;
      }
   }
}

@media (max-width: 991px) {
   .layout {
      .main {
         max-width: 100%;
      }
   }

   .admin-content {
      padding-top: $spacing-4;
      gap: $spacing-3;
      * {
         max-width: 100%;
      }

      .table {
         ul {
            gap: $spacing-1;
         }

         ul li {
            padding: $spacing-1;
            font-size: $body-small-size;
            flex: 1;
            min-width: 0;
            overflow: hidden;

            > * {
               overflow: hidden;
               text-overflow: ellipsis;
               white-space: nowrap;
               min-width: 0;
            }

            img {
               overflow: visible;
               text-overflow: clip;
               white-space: normal;
               flex-shrink: 0;
            }
         }
      }
   }
}

@media (max-width: 1024px) {
   .layout {
      .sidebar {
         position: fixed;
         left: 0;
         top: 0;
         height: 100vh;
         max-width: 280px;
         transform: translateX(-100%);
         box-shadow: $box-shadow-md;
         z-index: $z-index-modal;

         &.visible {
            transform: translateX(0);
         }
      }

      .history-panel {
         position: fixed;
         right: 0;
         top: 0;
         height: 100vh;
         max-width: 280px;
         transform: translateX(100%);
         box-shadow: $box-shadow-md;
         z-index: $z-index-modal;

         &.visible {
            transform: translateX(0);
         }
      }

      .main {
         width: 100%;
         margin: 0;
      }
   }

   .layout-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: $z-index-modal-backdrop;
      cursor: pointer;
      transition:
         opacity 0.3s ease,
         visibility 0.3s ease;
   }

   .sidebar:not(.visible) {
      @media (max-width: 1024px) {
         display: none;
      }
   }

   .history-panel {
      @media (max-width: 1024px) {
         display: none !important;
      }
   }

   .sidebar .sidebar-back-button {
      @media (max-width: 1024px) {
         display: block;
      }
   }

   .header {
      padding: $spacing-2;
      flex-wrap: wrap;
      gap: $spacing-1;

      p {
         font-size: $body-normal-size;
         padding: $spacing-1;
      }
   }

   .header-left,
   .header-right {
      gap: $spacing-1;
   }

   .header-right .icons {
      gap: $spacing-1;

      img {
         width: 20px;
         height: 20px;
      }
   }

   .admin-content {
      padding: $spacing-3 $spacing-2;
      gap: $spacing-2;
      overflow-x: visible;

      .table {
         width: 100%;
         height: auto;
         min-height: auto;
         overflow-x: visible; // 가로 스크롤 없음

         ul {
            gap: $spacing-1;
         }

         ul.header {
            position: relative;
            background-color: $white;
            z-index: 1;
            font-size: $body-small-size;
         }

         ul.data {
            font-size: $body-small-size;
         }

         ul li {
            padding: $spacing-1;
            min-width: 0;
            overflow: hidden;
            white-space: nowrap;

            > * {
               overflow: hidden;
               text-overflow: ellipsis;
               white-space: nowrap;
               min-width: 0;
            }

            img {
               overflow: visible;
               text-overflow: clip;
               white-space: normal;
               flex-shrink: 0;
            }
         }
      }
   }

   .sidebar {
      padding: $spacing-3 $spacing-2;
   }

   .history-panel {
      padding: $spacing-3 $spacing-2;
   }
}

@media (max-width: 575px) {
   .layout {
      .sidebar {
         max-width: 260px;
      }

      .history-panel {
         max-width: 260px;
      }
   }

   .header {
      padding: $spacing-1 $spacing-2;

      p {
         font-size: $body-small-size;
         padding: $spacing-1;
      }
   }

   .header-right .icons img {
      width: 18px;
      height: 18px;
   }

   .admin-content {
      padding: $spacing-2 $spacing-1;
      gap: $spacing-2;
      overflow-x: visible;

      .table {
         overflow-x: visible; // 가로 스크롤 없음

         ul {
            gap: $spacing-1;
            font-size: $body-small-size;
         }

         ul.header {
            font-size: $body-small-size;
         }

         ul.data {
            font-size: $body-small-size;
         }

         ul li {
            padding: $spacing-1;
            min-width: 0;
            overflow: hidden;
            font-size: $body-small-size;
            white-space: nowrap; // 1줄로 고정

            > * {
               overflow: hidden;
               text-overflow: ellipsis;
               white-space: nowrap;
               min-width: 0;
            }

            img {
               overflow: visible;
               text-overflow: clip;
               white-space: normal;
               flex-shrink: 0;
            }
         }
      }

      .button {
         margin-top: $spacing-3;

         button {
            max-width: 100%;
            width: 100%;
         }
      }
   }

   .sidebar {
      padding: $spacing-2 $spacing-1;

      .sidebar--tap {
         margin-top: $spacing-3;

         ul li {
            padding: $spacing-1;
            font-size: $body-small-size;
         }
      }
   }

   .history-panel {
      padding: $spacing-2 $spacing-1;

      ul li {
         padding: $spacing-1;
         font-size: $body-small-size;
      }
   }
}
